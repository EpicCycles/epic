{% extends 'epic/base.html' %}

{% block content %}
<table width="100%"><tr>
    <td><h2>Quote</h2></td>
    <td class="page_actions">
      <a href="{% url 'quote_requote' pk=quote.pk %}"  {% if quote.can_be_edited %} class="button" {% else %} class="button disabled" onclick="return false;" {% endif %}>Edit Quote</a>
      <a href="{% url 'quote_order' pk=quote.pk %}"  {% if quote.can_be_ordered %} class="button" {% else %} class="button disabled" onclick="return false;" {% endif %}>Place Order</a>
      <a href="{% url 'copy_quote' pk=quote.pk %}" class="button">Copy to New quote</a>
    </td>
</tr></table>
<table>
  <tr>
    <th>Customer</th>
    <td colspan=5>{{ quote.customer }}</td>
  </tr>
  <tr>
    <th>Complete Bike</th>
    <td colspan=5>{{ quote.frame }}</td>
  </tr>
    {% for section, sectionContents in quoteSections%}
        {% for quotePart, quotePartAttributes in sectionContents %}
          {% cycle 'row1' 'row2' as rowcolors silent %}
          <tr class="{{ rowcolors }}">
            <td class="section_part">{% if forloop.counter == 1 %}{{ section.name }}{% endif %}</td>
            <td>{{ quotePart.partType }}</td>
            <td>
              {{ quotePart.part }}
              {% if quotePart.sell_price != None %}<span class="red">**</span>{% endif %}
            </td>
            <td><table><tr>
              {% for quotePartAttribute in quotePartAttributes %}
              <td>{{ quotePartAttribute.partTypeAttribute }}: {{ quotePartAttribute.attribute_value }}</td>
              {% endfor %}
            </tr></table></td>
            <td class="align_right">{% if quotePart.quantity > 1 %}({{ quotePart.quantity }}){% endif %}</td>
            <td class="align_right">{% if quotePart.sell_price != None %}&pound;{{ quotePart.sell_price }}{% endif %}</td>
          </tr>
        {% endfor %}
      {% endfor %}
    <tr>
      <th class="align_right" colspan=5>Quote Total</th>
      <th class="align_right">&pound;{{ quote.keyed_sell_price }}</th>
    </tr>
</table>
{% endblock %}
